<!doctype html>
<html lang="en">

<head>
  <!-- Meta -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>GoLearn School</title>
  <meta name=description content="GoLearn School&trade; is Malaysia #1 teaching platform to run your tuition business and manage your lessons. Start now for Free!">
  <meta property=og:title content="GoLearn School">
  <meta property=og:site_name content="GoLearn School">
  <meta property=og:type content=website>
  <meta property=og:url content=https://app.golearn.com.my/school/student/edit-student.html>
  <meta property=og:image content=https://app.golearn.com.my/assets/img/icon-apple-touch-180x180.png>
  <meta property=og:description content="GoLearn School&trade; is Malaysia #1 teaching platform to run your tuition business and manage your lessons. Start now for Free!">
  <link rel=apple-touch-icon sizes=180x180 href=https://app.golearn.com.my/assets/img/icon-apple-touch-180x180.png>
  <link rel=icon type=image/png sizes=32x32 href=https://app.golearn.com.my/assets/img/icon-32x32.png>
  <link rel=icon type=image/png sizes=16x16 href=https://app.golearn.com.my/assets/img/icon-16x16.png>
  <!-- Fonts and icons -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" rel="stylesheet" type="text/css" />
  <script src="https://kit.fontawesome.com/2bdd669e92.js" crossorigin="anonymous"></script>
  <!-- Material Kit CSS -->
  <link href="../../assets/css/material-dashboard.css?v=2.1.2" rel="stylesheet" />
  <!-- Firebase Init -->
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-firestore.js"></script>
  <script src="../../assets/js/firebase.js"></script>
  <script>
    const orgUrl = new URL(window.location.href).searchParams.get("url");
    const orgEnt = new URL(window.location.href).searchParams.get("ent");
    if (orgUrl === null || orgUrl === "" || orgEnt === null || orgEnt === "")
      window.location.href = 'http://127.0.0.1:8080/';
  </script>
  <!-- Tutor Portal specific CSS -->
  <link href="../../assets/css/tutor-portal.css" rel="stylesheet" />
  <!-- GL Org CSS -->
  <link href="../../assets/css/golearn-org.css" rel="stylesheet" />
  <link href="../../assets/css/multistepform.css" rel="stylesheet" />
  <link href="../../assets/css/multitabform.css" rel="stylesheet" />
  <link href="../../assets/css/mc-calendar.min.css" rel="stylesheet"/>
  <link href="../../assets/css/star-rating.css" media="all" rel="stylesheet" type="text/css"/>
  <link rel="stylesheet" href="../../assets/css/intlTelInput.css">
</head>

<body>

  <div class="wrapper ">
    <div class="sidebar" data-color="purple" data-background-color="white" data-image="../../assets/img/sidebar-3.jpg">
      <div class="logo">
        <a href="../" class="simple-text logo-mini" style="padding: 0.5rem" id="logoName" name="param-link">
        </a>
      </div>
      <div class="sidebar-wrapper">
        <ul class="nav" style="margin-bottom: 50px;">
          <li class="nav-item" perm="home">
            <a class="nav-link" href="../" name="param-link">
              <i class="far fa-chart-bar fa-fw nav-icon"></i>
              <p>Dashboard</p>
            </a>
          </li>
          <li class="nav-item hidden" perm="insight">
            <a class="nav-link" href="../report/" name="param-link">
              <i class="far fa-lightbulb fa-fw nav-icon"></i>
              <p>Insight</p>
            </a>
          </li>
          <li class="nav-item hidden" perm="teach">
            <h4 class="nav-link" style="margin-left: 1rem;">Teaching</h4>
          </li>
          <li class="nav-item hidden" perm="teach-class">
            <a class="nav-link" href="../class/" name="param-link">
              <i class="fas fa-chalkboard fa-fw nav-icon"></i>
              <p>Classes</p>
            </a>
          </li>
		  		<li class="nav-item hidden active" perm="teach-student">
            <a class="nav-link" href="../student/" name="param-link">
              <i class="fas fa-user-graduate fa-fw nav-icon"></i>
              <p>Students</p>
            </a>
          </li>
          <li class="nav-item hidden" perm="teach-teacher">
            <a class="nav-link" href="../teacher/" name="param-link">
              <i class="fas fa-chalkboard-teacher fa-fw nav-icon"></i>
              <p>Teachers</p>
            </a>
          </li>
          <li class="nav-item hidden" perm="fin">
            <h4 class="nav-link" style="margin-left: 1rem;">Financial</h4>
          </li>
          <li class="nav-item hidden" perm="fin-invoice">
            <a class="nav-link" href="../invoice/" name="param-link">
              <i class="fas fa-file-invoice-dollar fa-fw nav-icon"></i>
              <p>Invoices</p>
            </a>
          </li>
          <li class="nav-item hidden" perm="fin-payroll">
            <a class="nav-link" href="../payroll/" name="param-link">
              <i class="fas fa-hand-holding-usd fa-fw nav-icon"></i>
              <p>Payroll <span style="visibility: hidden;">PRO</span></p>
            </a>
          </li>
          <li class="nav-item hidden" perm="fin-transaction">
            <a class="nav-link" href="../transaction/" name="param-link">
              <i class="fas fa-exchange-alt fa-fw nav-icon"></i>
              <p>Transactions</p>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="main-panel">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top ">
        <div class="container-fluid">
          <div class="navbar-wrapper">
            <a class="navbar-brand" href="javascript:;">Student <span><i class="material-icons" style="color: gray;">chevron_right</i></span> Edit Student</a>
          </div>
          <button class="navbar-toggler" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
          </button>
          <div class="collapse navbar-collapse justify-content-end">
            <form class="navbar-form">
              <!-- Put empty placeholder here -->
            </form>

            <ul class="navbar-nav">
              <li class="nav-item" id="activationNavItem">
                <a href="#" class="btn btn-primary btn-round btn-sm" style="visibility: hidden;" id="btnActivateAccount"></a>
              </li>
              <li class="nav-item">
                <a class="navbar-brand" href="javascript:;">
                   Hi <span id="user"></span> !
                </a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link" href="javascript:;" id="navbarDropdownNotification" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="material-icons">notifications</i> Notifications
                </a>
								<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
									<p style="padding: 1em;" >No notification</p>
                </div>
              </li>

			  			<li class="nav-item dropdown">
                <a class="nav-link" href="javascript:;" id="navbarDropdownProfile" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="material-icons">person</i>
                  <p class="d-lg-none d-md-block">
                    Account
                  </p>
                </a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownProfile">
                  <a class="dropdown-item hidden" href="../settings/" name="param-link" perm="settings">Update Information</a>
                  <a class="dropdown-item hidden" href="../team/" name="param-link" perm="team">Team</a>
									<div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="../../">Back to Home</a>
                  <a class="dropdown-item" href="javascript:;" data-toggle="modal" data-target="#signOutModal" onclick="signOutFunction()" id="btn-logout">Log out</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <!-- End Navbar -->

			<!-- Modal Start -->

      <!-- Approve New Student modal -->
      <div class="row">
        <div class="modal fade" id="approveStuModal" tabindex="-1" role="dialog" aria-labelledby="approveStuModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="approveStuModalLabel"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnApproveStuModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="approveStuModalBody">
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnApproveStuModalClose2">Not Now</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnApproveStuModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Delete Student modal -->
      <div class="row">
        <div class="modal fade" id="delStuModal" tabindex="-1" role="dialog" aria-labelledby="delStuModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="delStuModalLabel"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnDelStuModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="delStuModalBody">
                <div id="delStuId" value=""></div>
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnDelStuModalClose2">Not Now</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnDelStuModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Save Student modal -->
      <div class="row">
        <div class="modal fade" id="saveModal" tabindex="-1" role="dialog" aria-labelledby="saveModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="saveLabel">Save & Close</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnSaveModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="saveModalBody">
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnSaveModalClose2">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnSaveModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Sign-out modal -->
      <div class="row">
        <div class="modal fade" id="signOutModal" tabindex="-1" role="dialog" aria-labelledby="signOutModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="signOutLabel">Logging Out</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="signOutModalBody">
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnSignOutModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>


      <div class="content">

        <div class="container overflow-hidden">

          <!-- Back button -->
          <div class="row d-flex" style="margin: auto 10px 0 10px;">
            <div class="p-2" style="padding: 0 8px 8px 0!important;">
              <a href="./" class="btn btn-outline-primary btn-round" id="btnBack" name="param-link"><i class="material-icons" style="color: #2e74b6; margin-right: 0.5em; padding-bottom: 0.2em;">west</i>Back</a>
            </div>
            <div class="p-2" style="padding: 0 8px 8px 0!important;">
              <a href="javascript:;" class="btn btn-outline-primary btn-round text-white hidden" id="btnSave" style="background: #2e74b6;" perm="teach-student-edit"><i class="material-icons" style="color: #ffffff; margin-right: 0.5em; padding-bottom: 0.2em;">save</i> Save</a>
            </div>
            <div class="p-2" style="padding: 0 8px 8px 0!important;">
              <a href="javascript:;" class="btn btn-warning btn-round hidden" id="btnApprove" data-toggle="modal" data-target="#approveStuModal" style="display: none;" perm="teach-student-edit">Approve ?</a>
            </div>
            <div class="ml-auto p-2" style="padding: 0 0 8px 0!important;">
              <a href="javascript:;" class="btn btn-danger btn-round hidden" data-toggle="modal" data-target="#delStuModal" perm="teach-student-del"><i class="material-icons" style="color: #ffffff; margin-right: 0.5em; padding-bottom: 0.2em;">remove</i>Remove</a>
            </div>
          </div>

          <div class="row">
            <div class="col-md-12">
              <!--multitabs-form navbar-->
              <div class="row" >
                <div class="col-12 col-lg-12 ml-auto mr-auto mb-4">
                  <div class="d-flex flex-wrap multitabs-form__progress">
                    <button class="multitabs-form__progress-btn js-active" type="button" title="Student Info">Student Profile</button>
                    <button class="multitabs-form__progress-btn" type="button" title="Guardian Info">Guardian Profile</button>
                  </div>
                </div>
              </div>

              <!--multitabs-form-->
              <div class="multitabs-form" id="multitabs_form">
                <!--form panels-->
                <div class="row">
                  <div class="col-12">
                    <form class="multitabs-form__form">
                      <!-- Student form panel-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white js-active" data-animation="scaleIn">
                        <h4 class="multitabs-form__title">Student Profile</h4>
                        <div class="multitabs-form__content">
                          <div class="row">
                              <!-- Name -->
                            <div class="col-md-6">
                              <div class="form-group">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Full Name*</span>
                                <input type="text" class="form-control" id="inStuName" data-compulsory="true" oninput="this.className = 'form-control'">
                              </div>
                            </div>

                            <!-- Phone -->
                            <div class="col-md-6">
                              <div class="form-group" style="padding-bottom: 0;">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Phone</span>
                              </div>
                              <div class="form-group" style="margin-top: 0;">
                                <!-- <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Phone*</span>  -->
                                <!-- <i style="margin-right: 1rem;" class="material-icons">smartphone</i> -->
                                <input id="phoneStudent" name="phone" type="tel" class="form-control">
                                <span id="valid-msgStudent" class="hide" style="color: #42ba96;">✓ Valid</span>
                                <span id="error-msgStudent" class="hide" style="color: #F32013;"></span>
                              </div>
                            </div>
                          </div>

                          <div class="row">
                            <!-- Email -->
                            <div class="col-md-6">
                              <div class="form-group" >
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Email</span>
                                <input type="text" class="form-control" id="inStuEmail" data-compulsory="false" oninput="this.className = 'form-control'">
                              </div>
                            </div>

                            <!-- Gender -->
                            <div class="col-md-6">
                              <span class="" style="font-size: smaller; font-weight: 300; color: gray; padding-right: 2rem;" >Gender</span>
                              <div class="form-group" >
                                <div class="form-check form-check-radio form-check-inline">
                                  <label class="form-check-label">
                                    <input class="form-check-input" type="radio" name="StudentGender" id="inStuMaleChecked" value="option1" data-compulsory="false" checked>
                                    Male
                                    <span class="circle">
                                      <span class="check"></span>
                                    </span>
                                  </label>
                                </div>
                                <div class="form-check form-check-radio form-check-inline">
                                  <label class="form-check-label">
                                    <input class="form-check-input" type="radio" name="StudentGender" id="inStuFemaleChecked" value="option2" data-compulsory="false">
                                    Female
                                    <span class="circle">
                                      <span class="check"></span>
                                    </span>
                                  </label>
                                </div>
                              </div>
                            </div>
                          </div>

                          <div class="row">
                            <!-- School -->
                            <div class="col-md-12">
                              <div class="form-group">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">School</span>
                                <input type="text" class="form-control" id="inStuSchool" data-compulsory="false" oninput="this.className = 'form-control'">
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Guardian form panel-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                        <h4 class="multitabs-form__title">Guardian Profile</h4>
                        <div class="multitabs-form__content">
                          <div class="row">
                              <!-- Name -->
                            <div class="col-md-6">
                              <div class="form-group">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Name*</span>
                                <input type="text" class="form-control" id="inGurName" data-compulsory="true" oninput="this.className = 'form-control'" >
                              </div>
                            </div>

                            <!-- Phone -->
                            <div class="col-md-6">
                              <div class="form-group" style="padding-bottom: 0;">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Phone*</span>
                              </div>
                              <div class="form-group" style="margin-top: 0;">
                                <!-- <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Phone*</span>  -->
                                <!-- <i style="margin-right: 1rem;" class="material-icons">smartphone</i> -->
                                <input id="phoneGurdian" name="phone" type="tel" data-compulsory="true" class="form-control">
                                <span id="valid-msgGuardian" class="hide" style="color: #42ba96;">✓ Valid</span>
                                <span id="error-msgGuardian" class="hide" style="color: #F32013;"></span>
                              </div>
                            </div>


                          </div>

                          <div class="row">
                            <!-- Email -->
                            <div class="col-md-6">
                              <div class="form-group" >
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Email</span>
                                <input type="text" class="form-control" id="inGurEmail" data-compulsory="false" oninput="this.className = 'form-control'">
                              </div>
                            </div>

                            <!-- Gender -->
                            <div class="col-md-6">
                              <span class="" style="font-size: smaller; font-weight: 300; color: gray; padding-right: 2rem;" >Gender</span>
                              <div class="form-group" >
                                <div class="form-check form-check-radio form-check-inline">
                                  <label class="form-check-label">
                                    <input class="form-check-input" type="radio" name="GurdianGender" id="inGurMaleChecked" value="option1" data-compulsory="false" checked>
                                    Male
                                    <span class="circle">
                                      <span class="check"></span>
                                    </span>
                                  </label>
                                </div>
                                <div class="form-check form-check-radio form-check-inline">
                                  <label class="form-check-label">
                                    <input class="form-check-input" type="radio" name="GurdianGender" id="inGurFemaleChecked" value="option2" data-compulsory="false">
                                    Female
                                    <span class="circle">
                                      <span class="check"></span>
                                    </span>
                                  </label>
                                </div>
                              </div>
                            </div>
                          </div>

                          <div class="row">
                            <!-- Relationship -->
                            <div class="col-md-6">
                              <span class="" style="font-size: smaller; font-weight: 300; color: gray; padding-right: 2rem;" >Relationship</span>
                              <div class="form-group" >
                                <div class="form-check form-check-radio form-check-inline">
                                  <label class="form-check-label">
                                    <input class="form-check-input" type="radio" name="GuardianRelationship" id="inRelParentsChecked" value="option1" data-compulsory="false" checked>
                                      Parents
                                    <span class="circle">
                                      <span class="check"></span>
                                    </span>
                                  </label>
                                </div>
                                <div class="form-check form-check-radio form-check-inline">
                                  <label class="form-check-label">
                                    <input class="form-check-input" type="radio" name="GuardianRelationship" id="inRelGurdianChecked" value="option2" data-compulsory="false">
                                      Legal Guardian
                                    <span class="circle">
                                      <span class="check"></span>
                                    </span>
                                  </label>
                                </div>
                              </div>
                            </div>

                            <!-- Address -->
                            <div class="col-md-12">
                              <div class="form-group" style="margin-top: 1.5rem;" >
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Address</span>
                                <textarea class="form-control" maxlength="511" rows="3" id="inGurAddress" data-compulsory="false" placeholder="Write something ..."></textarea>
                              </div>
                            </div>
                          </div>

                          <div class="row" style="margin-top: 0.5rem;">
                            <div class="col-md-6">
                                <!-- State -->
                              <div class="form-group">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray;">State</span>
                                <select class="form-control" name="tutor_course[]" id="state_drop" data-compulsory="false" oninput="this.className = 'form-control'">
                                  <option value="">Select state</option>

                                </select>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <!-- Area -->
                              <div class="form-group">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray;" >Area</span>
                                <select class="form-control" name="tutor_course[]" id="area_drop" data-compulsory="false" oninput="this.className = 'form-control'">
                                  <option value="">Select area</option>
                                </select>
                              </div>
                            </div>
                          </div>

                        </div>
                      </div>

                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <footer class="footer">
        <div class="container-fluid">
          <nav class="float-left">
          <ul>
            <!-- <li>
            <a href="https://golearn.com.my/join-us" target="_blank">
              Visit GoLearn Tutor
            </a>
            </li> -->
          </ul>
          </nav>
          <!-- <div class="copyright float-right">
            &copy;
            <script>
              document.write(new Date().getFullYear())
            </script>
            , made with <i class="material-icons">favorite</i> by <a href="#" >GoLearn Team</a>
          </div> -->
          <!-- your footer here -->
        </div>
      </footer>
    </div>

  </div>


  <script src="../../assets/js/core/jquery.min.js"></script>
  <script src="../../assets/js/core/popper.min.js"></script>
  <script src="../../assets/js/core/bootstrap-material-design.min.js"></script>
  <script src="../../assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!-- Plugin for the momentJs  -->
  <script src="../../assets/js/plugins/moment.min.js"></script>
  <!--  Plugin for Sweet Alert -->
  <script src="../../assets/js/plugins/sweetalert2.js"></script>
  <!-- Forms Validations Plugin -->
  <script src="../../assets/js/plugins/jquery.validate.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="../../assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="../../assets/js/material-dashboard.js?v=2.1.2" type="text/javascript"></script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.min.js" integrity="sha384-lpyLfhYuitXl2zRZ5Bn2fqnhNAKOAaM/0Kr9laMspuaMiZfGmfwRNFh8HlMy49eQ" crossorigin="anonymous"></script>
  <!-- Common constants -->
  <script src="../../assets/js/common.js" type="text/javascript"></script>
  <!-- General Info -->
  <script src="../../assets/js/const.js" type="text/javascript"></script>
  <!-- Core Tutor Js -->
  <script src="../../assets/js/org-core.js" type="text/javascript"></script>
  <!-- Datepicker -->
  <script src="../../assets/js/mc-calendar.min.js" type="text/javascript"></script>
  <!-- ClockPicker -->
  <script type="text/javascript" src="../../assets/js/bootstrap-clockpicker.min.js"></script>
  <script src="../../assets/js/star-rating.js" type="text/javascript"></script>
  <script src="../../assets/js/star-rating-theme.js" type="text/javascript"></script>
  <!-- International Telephone Input -->
  <script src="../../assets/js/plugins/intlTelInput/intlTelInput.min.js"></script>

  <script>

		// var db = firebase.firestore();
		// db.settings({ timestampsInSnapshots: true });

    // Check the current CLASS in session Storage - Valid only if user come from class.html
    var currentStudentObj = null;
    var gState, gArea, gStateName, gAreaName;

    const sid = new URL(window.location.href).searchParams.get("sid")

    getStudentObject()


    // Initialization
    AuthCheck();

    // Page Specific Initialization
    function loadPageInitFunc(){
      // Do nothing

    }

    function getStudentObject() {

      if (sid === null || sid === ''){
        func.showNotification('top','center', 'danger', 'error_outline', "Error: No student id in params." );
        alert('Error: No Student ID found.')
        window.location.href='./?url=' + orgUrl + "&ent=" + orgEnt;
      }
      else {
        let docRef = db.collection("dev")
          .doc("v2")
          .collection("Student")
          .doc(sid);

        docRef.get().then((doc) => {
          if (doc.exists) {

            console.log(doc.data())
            // Store in lacal variable
            currentStudentObj = doc.data()

            // Global var
            gState =doc.data()[STU_GUR_STATE_ID];
            gArea =doc.data()[STU_GUR_AREA_ID];
            gStateName='';
            gAreaName ='';


            updatePageContent(doc.data())

          }
          else {
            func.showNotification('top','center', 'danger', 'error_outline', "Error: No such student." );
            alert('Error: No such student.')
            window.location.href='./?url=' + orgUrl + "&ent=" + orgEnt;

          }
        })
      }
    }

    function updatePageContent(data){

      // Button view
      if (data[STU_ENROLLMENT_STATUS] === STU_ENROLLMENT_STATUS_PENDING){
        document.getElementById("btnApprove").style.display = 'inline-block';
      }else{
        document.getElementById("btnApprove").style.display = 'none';
      }

      // Student Profile
      document.getElementById("inStuName").value = data[STU_CHILD_NAME];
      // document.getElementById("phoneStudent").value = data[STU_CHILD_PHONE];
      itiStudent.setNumber(data[STU_CHILD_PHONE]);
      document.getElementById("inStuEmail").value = data[STU_CHILD_EMAIL];
      document.getElementById("inStuMaleChecked").checked = data[STU_CHILD_GENDER] === 0 ? true : false;
      document.getElementById("inStuFemaleChecked").checked = data[STU_CHILD_GENDER] === 1 ? true : false;
      document.getElementById("inStuSchool").value = data[STU_CHILD_SCHOOL];

      // Parent Profile Panel
      document.getElementById("inGurName").value = data[STU_GUR_NAME];
      document.getElementById("phoneGurdian").value = data[STU_GUR_PHONE];
      itiGuardian.setNumber(data[STU_GUR_PHONE]);
      document.getElementById("inGurEmail").value = data[STU_GUR_EMAIL];
      document.getElementById("inGurMaleChecked").checked = data[STU_GUR_GENDER] === 0 ? true : false;
      document.getElementById("inGurFemaleChecked").checked = data[STU_GUR_GENDER] === 1 ? true : false;
      document.getElementById("inRelParentsChecked").checked = data[STU_GUR_RELATIONSHIP] === STU_GUR_RELATIONSHIP_PARENTS ? true : false;
      document.getElementById("inRelGurdianChecked").checked = data[STU_GUR_RELATIONSHIP] === STU_GUR_RELATIONSHIP_GUARDIAN ? true : false;
      document.getElementById("inGurAddress").value = data[STU_GUR_ADDR];


      // ------State Dropdown start------- //
      let state_select = document.getElementById("state_drop");
      let state = MYAllState;
      let stateId = MYAllStateId;
      for (let i = 0; i < state.length; i++) {
          let el = document.createElement("option");
          el.textContent = state[i];
          el.value = stateId[i];

          // Update State
          if (stateId[i] === data[STU_GUR_STATE_ID]) {
            el.selected = true;
          }
          state_select.appendChild(el);
      }

      // Update Area
      // Clear the area option first, except the first one. 100 is just a huge number
      let select_area = document.getElementById("area_drop");
      for(i=1; i <= 100; i++){
          select_area.remove(1);
      }
      if (!(data[STU_GUR_STATE_ID] == null || data[STU_GUR_STATE_ID] =='')){
        let cityInfo = selectCityListBasedOnStateId(data[STU_GUR_STATE_ID]);
        let cityName = cityInfo[0];
        let cityId = cityInfo[1];
        for (let i = 0; i < cityName.length; i++) {
            let el = document.createElement("option");
            el.textContent = cityName[i];
            el.value = cityId[i];
            // Default selection based on existing class
            if (cityId[i] === data[STU_GUR_AREA_ID]) {
              el.selected = true;
            }
            select_area.appendChild(el);
        }
      }
    }

    // Update Student Info
    function UpdateStudentToDB(id){
      var docRef = db.collection("dev")
          .doc("v2")
          .collection("Student")
          .doc(id);

      let data = {
        [STU_VIEWER_ID]: [itiGuardian.getNumber(),itiStudent.getNumber()],
        [STU_DATE_EDIT]: new Date(),
        [STU_ADMIN_NAME]: ent_name,
        [STU_ADMIN_PHONE]: ent_phone,
        [STU_ADMIN_ADDR]: ent_addr,
        [STU_ADMIN_IMG_URL]: ent_imgUrl,
        [STU_GUR_ID]: itiGuardian.getNumber(),
        [STU_GUR_RELATIONSHIP]: document.getElementById("inRelParentsChecked").checked ? STU_GUR_RELATIONSHIP_PARENTS : STU_GUR_RELATIONSHIP_GUARDIAN,
        [STU_GUR_NAME]: document.getElementById("inGurName").value,
        [STU_GUR_PHONE]: itiGuardian.getNumber(),
        [STU_GUR_GENDER]: document.getElementById("inGurMaleChecked").checked ? 0 : 1,
        [STU_GUR_EMAIL]: document.getElementById("inGurEmail").value,
        [STU_GUR_ADDR]: document.getElementById("inGurAddress").value,
        [STU_GUR_STATE_ID]: gState,
        [STU_GUR_AREA_ID]: gArea,
        [STU_CHILD_ID]: itiStudent.getNumber(),
        [STU_CHILD_NAME]: document.getElementById("inStuName").value,
        [STU_CHILD_PHONE]: itiStudent.getNumber(),
        [STU_CHILD_GENDER]: document.getElementById("inStuMaleChecked").checked ? 0 : 1,
        [STU_CHILD_EMAIL]: document.getElementById("inStuEmail").value,
        [STU_CHILD_SCHOOL]: document.getElementById("inStuSchool").value,

      }


      // console.log("StudentData");
      // console.log(data);
      var docRefWithMerge = docRef.set(data , { merge: true })
      .then(() => {
        func.showNotification('top','center', 'success', 'check_circle', "Saved");
        // window.location = "./";
      }).catch((error) => {
        console.log("Error getting document:", error);
      });
    }

    // Report: Update Student Number
    function updateStudentNum(value){

      let docRef = db.collection("dev")
        .doc("v2")
        .collection("General")
        .where(NUM_ADMIN_ID, "==", ent_id)
        .where(NUM_TYPE, "==", NUM_TYPE_STUDENT)
        .limit(1);


      docRef
      .get()
      .then((querySnapshot) => {

        if(querySnapshot.empty) {
          console.log("Empty. Do nothing ");

        }
        else {
          // console.log("Data found Update: ");

          querySnapshot.forEach((doc) => {

            console.log(doc.data());

            let reportDocRef = db.collection("dev")
              .doc("v2")
              .collection("General")
              .doc(doc.data()[NUM_ID]);


            reportData ={
              // [NUM_ID]: reportDocRef.id,
              // [NUM_ADMIN_ID]: ent_id,
              // [NUM_TYPE]: ,
              [NUM_VALUE]: (value == null || value == "" || value == 0 || isNaN(value)) ? 1 : parseInt(doc.data()[NUM_VALUE]) - parseInt(value),
              [NUM_DATE_EDIT]: new Date(),
            }

            console.log(reportData)
            reportDocRef
              .set(reportData, { merge: true })
              .then(() => {
                window.location = "./"
              });

          });


        }


      });

    }

  </script>

  <script>

    $( document ).ready(function() {


      // Populate Area based on selected State
      $('#state_drop').on('change', function(){
        // Initialization
        // Reasign area after the statre change. It suppose to be defaulted to "Select area"
        gArea = '';
        gAreaName = '';

        // Get the val and txt of the selected state
        let StateId = $(this).val();
        let StateName = $(this).find("option:selected").text();
        gState = StateId;
        gStateName = StateName

        let select_area = document.getElementById("area_drop");
        // Clear the area option first, except the first one. 100 is just a magic number
        for(i=1; i <= 100; i++){
            select_area.remove(1);
        }

        // Generate all cities based on stateId
        if  (!(StateId == "" || StateId == null )){
          let stateInfo = selectCityListBasedOnStateId (gState);
          for (let i = 0; i < stateInfo[0].length; i++) {
            let el = document.createElement("option");
            el.textContent = stateInfo[0][i];
            el.value = stateInfo[1][i];;
            select_area.appendChild(el);
          }
        }
      });

      // ------Area Dropdown Start------- //
      $('#area_drop').on('change', function(){
          gArea = $(this).val()
          gAreaName = $(this).find("option:selected").text();
      });

      // Save student info
      $('#btnSave').on('click', function (e) {
        let fieldsValid = ValidateFields('multitabs_form');
        let phoneValid = ValidatePhone('phoneGurdian');
        if (fieldsValid && phoneValid){
          $('#saveModal').modal('show');
        }
      });

      $('#btnSaveModalUpdate').on('click', function (e) {
        $('#saveModal').modal('hide');
        UpdateStudentToDB(currentStudentObj[STU_ID]);
      });

      $('#btnSaveModalClose1').on('click', function (e) {
        $('#saveModal').modal('hide');
      });

      $('#btnSaveModalClose2').on('click', function (e) {
        $('#saveModal').modal('hide');
      });

      // Approve New Student Modal
      $('#approveStuModal').on('show.bs.modal', function (event) {

        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
        var modal = $(this)
        modal.find('.modal-title').text('New Student: '+ currentStudentObj[STU_CHILD_NAME] +'. Approve ?');

      });

      $('#btnApproveStuModalUpdate').on('click', function (e) {

        var docRef = db.collection("dev")
          .doc("v2")
          .collection("Student")
          .doc(currentStudentObj[STU_ID]);

        let data = {
          [STU_ENROLLMENT_STATUS]: STU_ENROLLMENT_STATUS_ACTIVE,
        }
        // console.log(studentId);
        console.log(data);
        var docRefWithMerge = docRef.set(data , { merge: true })
        .then(() => {
          window.location = "./";
        }).catch((error) => {
          console.log("Error getting document:", error);
        });


      });


      // Delete Student Modal
      $('#delStuModal').on('show.bs.modal', function (event) {

        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
        var modal = $(this)
        modal.find('.modal-title').text('Delete '+ currentStudentObj[STU_CHILD_NAME] +' ?');

      });

      $('#btnDelStuModalUpdate').on('click', function (e) {

        var docRef = db.collection("dev")
          .doc("v2")
          .collection("Student")
          .doc(currentStudentObj[STU_ID]);

        // TODO: When deleting a student, also delete the Class_Student doc linked.

        // console.log(studentId);
        // console.log(data);
        var docRefWithMerge = docRef.delete()
        .then(() => {

          return Promise.resolve( updateGeneralReportNum(ent_id, NUM_TYPE_STUDENT, 'desc', 1) )

          // window.location = "./";
        })
        .then(() => {
          window.location.href='./?url=' + orgUrl + "&ent=" + orgEnt;
        })
        .catch((error) => {
          console.log("Error getting document:", error);
        });


      });


    });

  </script>


  <!-- Multiform-specific script -->
  <script>
    //DOM elements
    const DOMstrings = {
      stepsBtnClass: 'multitabs-form__progress-btn',
      stepsBtns: document.querySelectorAll(`.multitabs-form__progress-btn`),
      stepsBar: document.querySelector('.multitabs-form__progress'),
      stepsForm: document.querySelector('.multitabs-form__form'),
      stepsFormTextareas: document.querySelectorAll('.multitabs-form__textarea'),
      stepFormPanelClass: 'multitabs-form__panel',
      stepFormPanels: document.querySelectorAll('.multitabs-form__panel'),
      stepPrevBtnClass: 'js-btn-prev',
      stepNextBtnClass: 'js-btn-next',
      stepSendBtnClass: 'js-btn-send' };


    //remove class from a set of items
    const removeClasses = (elemSet, className) => {

      elemSet.forEach(elem => {

        elem.classList.remove(className);

      });

    };

    //return exect parent node of the element
    const findParent = (elem, parentClass) => {

      let currentNode = elem;

      while (!currentNode.classList.contains(parentClass)) {
        currentNode = currentNode.parentNode;
      }

      return currentNode;

    };

    //get active button step number
    const getActiveStep = elem => {
      return Array.from(DOMstrings.stepsBtns).indexOf(elem);
    };

    //set all steps before clicked (and clicked too) to active
    const setActiveStep = activeStepNum => {

      //remove active state from all the state
      removeClasses(DOMstrings.stepsBtns, 'js-active');

      //set picked items to active
      DOMstrings.stepsBtns.forEach((elem, index) => {

        if (index == activeStepNum) {
          elem.classList.add('js-active');
        }

      });
    };

    //get active panel
    const getActivePanel = () => {

      let activePanel;

      DOMstrings.stepFormPanels.forEach(elem => {

        if (elem.classList.contains('js-active')) {

          activePanel = elem;

        }

      });

      return activePanel;

    };

    //open active panel (and close unactive panels)
    const setActivePanel = activePanelNum => {

      //remove active class from all the panels
      removeClasses(DOMstrings.stepFormPanels, 'js-active');

      //show active panel
      DOMstrings.stepFormPanels.forEach((elem, index) => {
        if (index === activePanelNum) {

          elem.classList.add('js-active');

          setFormHeight(elem);

        }
      });

    };

    //set form height equal to current panel height
    const formHeight = activePanel => {

      const activePanelHeight = activePanel.offsetHeight;

      DOMstrings.stepsForm.style.height = `${activePanelHeight}px`;

    };

    const setFormHeight = () => {
      const activePanel = getActivePanel();

      formHeight(activePanel);
    };

    //STEPS BAR CLICK FUNCTION
    DOMstrings.stepsBar.addEventListener('click', e => {

      //check if click target is a step button
      const eventTarget = e.target;

      if (!eventTarget.classList.contains(`${DOMstrings.stepsBtnClass}`)) {
        return;
      }



      //get active button step number
      const activeStep = getActiveStep(eventTarget);

      //set all steps before clicked (and clicked too) to active
      setActiveStep(activeStep);

      //open active panel
      setActivePanel(activeStep);
    });

    //PREV/NEXT BTNS CLICK
    DOMstrings.stepsForm.addEventListener('click', e => {

      const eventTarget = e.target;

      //check if we clicked on `PREV` or NEXT` buttons
      if (eventTarget.classList.contains(`${DOMstrings.stepSendBtnClass}`))
      {
        // Notice that I use .add(..), instead of .set(..). This is because the docRef do not specify the docId.
      }
      else if (eventTarget.classList.contains(`${DOMstrings.stepPrevBtnClass}`) || eventTarget.classList.contains(`${DOMstrings.stepNextBtnClass}`))
      {
        // Proceed to move to next / prev page
      }else{
        // Do nothing and return
        return;

      }

      //find active panel
      const activePanel = findParent(eventTarget, `${DOMstrings.stepFormPanelClass}`);

      let activePanelNum = Array.from(DOMstrings.stepFormPanels).indexOf(activePanel);
      getAllTimeSlots()
      //set active step and active panel onclick
      if (eventTarget.classList.contains(`${DOMstrings.stepPrevBtnClass}`)) {
        activePanelNum--;

        setActiveStep(activePanelNum);
        setActivePanel(activePanelNum);
      } else {

        if (!validateForm(activePanelNum)){

        }else{
          activePanelNum++;
          setActiveStep(activePanelNum);
          setActivePanel(activePanelNum);
        }
      }
      // setActiveStep(activePanelNum);
      // setActivePanel(activePanelNum);
    });

    //SETTING PROPER FORM HEIGHT ONLOAD
    window.addEventListener('load', setFormHeight, false);

    //SETTING PROPER FORM HEIGHT ONRESIZE
    window.addEventListener('resize', setFormHeight, false);

    //changing animation via animation select !!!YOU DON'T NEED THIS CODE (if you want to change animation type, just change form panels data-attr)

    const setAnimationType = newType => {
      DOMstrings.stepFormPanels.forEach(elem => {
        elem.dataset.animation = newType;
      });
    };

    function validateForm(activePanelNum) {
      // This function deals with validation of the form fields with data-compulsory = 'true'
      var x, y, i, valid = true;
      x = document.getElementsByClassName("multitabs-form__panel");
      // y = x[activePanelNum].getElementsByTagName("input") && x[activePanelNum].querySelectorAll('[type="text"]');
      y =x[activePanelNum].querySelectorAll('[data-compulsory="true"]');

      // A loop that checks every input field in the current tab:
      for (i = 0; i < y.length; i++) {
        // console.log(y[i].value)
        // If a field is empty...
        if (y[i].value == "") {
          // add an "invalid" class to the field:
          y[i].className += " invalid";
          // and set the current valid status to false:
          valid = false;
        }
      }
      // If the valid status is true, mark the step as finished and valid:
      if (valid) {
        // document.getElementsByClassName("step")[activePanelNum].className += " finish";
      }
      return valid; // return the valid status
    }

  </script>

  <script>
    var inputStudent = document.querySelector("#phoneStudent");
    var inputGuardian = document.querySelector("#phoneGurdian");
    var itiStudent = intlTelInput(inputStudent,{
      autoHideDialCode: false,
      preferredCountries: ['my', 'sg'],
      separateDialCode: true,
      utilsScript: "https://golearn.com.my/assets/js/plugins/intlTelInput/utils.js",
      });

    var itiGuardian = intlTelInput(inputGuardian,{
    autoHideDialCode: false,
    // nationalMode: false,
    preferredCountries: ['my', 'sg'],
    separateDialCode: true,
    utilsScript: "https://golearn.com.my/assets/js/plugins/intlTelInput/utils.js",
    });

    var errorMsgStudent = document.querySelector("#error-msgStudent");
    var validMsgStudent = document.querySelector("#valid-msgStudent");
    var errorMsgGuardian = document.querySelector("#error-msgGuardian");
    var validMsgGuardian = document.querySelector("#valid-msgGuardian");

    // here, the index maps to the error code returned from getValidationError - see readme
    var errorMap = ["Invalid number", "Invalid country code", "Too short", "Too long", "Invalid number"];

    var resetStudent = function() {
      inputStudent.classList.remove("error");
      errorMsgStudent.innerHTML = "";
      errorMsgStudent.classList.add("hide");
      validMsgStudent.classList.add("hide");
    };
    var resetGuardian = function() {
      inputGuardian.classList.remove("error");
      errorMsgGuardian.innerHTML = "";
      errorMsgGuardian.classList.add("hide");
      validMsgGuardian.classList.add("hide");
    };
    // on blur: validate
    inputStudent.addEventListener('blur', function() {
      resetStudent();
      if (inputStudent.value.trim()) {
        if (itiStudent.isValidNumber()) {
          validMsgStudent.classList.remove("hide");
        } else {
          inputStudent.classList.add("error");
          var errorCode = itiStudent.getValidationError();
          errorMsgStudent.innerHTML = errorMap[errorCode];
          errorMsgStudent.classList.remove("hide");
        }
      }
    });
    inputGuardian.addEventListener('blur', function() {
      resetGuardian();
      if (inputGuardian.value.trim()) {
        if (itiGuardian.isValidNumber()) {
          validMsgGuardian.classList.remove("hide");
        } else {
          inputGuardian.classList.add("error");
          var errorCode = itiGuardian.getValidationError();
          errorMsgGuardian.innerHTML = errorMap[errorCode];
          errorMsgGuardian.classList.remove("hide");
        }
      }
    });

    // on keyup / change flag: reset
    inputStudent.addEventListener('change', resetStudent);
    inputStudent.addEventListener('keyup', resetStudent);
    inputGuardian.addEventListener('change', resetGuardian);
    inputGuardian.addEventListener('keyup', resetGuardian);

    // Validate fields in based on parents.
    function ValidateFields(parentId){
      // This function deals with validation of the form fields with data-compulsory = 'true'
      var x, y, i, valid = true;
      x = document.getElementById(parentId);
      y =x.querySelectorAll('[data-compulsory="true"]');

      // A loop that checks every input field in the current tab:
      for (i = 0; i < y.length; i++) {
        // console.log(y[i].value)
        // If a field is empty...
        if (y[i].value == "") {
          // add an "invalid" class to the field:
          y[i].className += " invalid";
          // and set the current valid status to false:
          valid = false;
        }
      }
      return valid; // return the valid status
    }

    // Validate fields - Phone Input specific.
    function ValidatePhone(phoneId){
      var valid = true;
      let inPhone = document.querySelector("#"+phoneId);
      // console.log(inPhone.value)
      if (inPhone.value.trim()) {
        if (itiGuardian.isValidNumber()) {
          // Do nothing
        } else {
          inPhone.className += " invalid";
          valid = false;
        }
      }
      return valid; // return the valid status
    }

  </script>


</body>

</html>